"use strict";(self.webpackChunkhcihub_docs=self.webpackChunkhcihub_docs||[]).push([[8693],{2446:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>t,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"datasets/invasive/Visual Grating Task","title":"10_Visual Grating Task","description":"Preprocessing Pipeline Documentation","source":"@site/docs/datasets/invasive/10_Visual Grating Task.md","sourceDirName":"datasets/invasive","slug":"/datasets/invasive/Visual Grating Task","permalink":"/BCIJelly-site/docs/next/datasets/invasive/Visual Grating Task","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/datasets/invasive/10_Visual Grating Task.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"9_Visual Neuropixel","permalink":"/BCIJelly-site/docs/next/datasets/invasive/Visual Neuropixel"},"next":{"title":"11_Speech","permalink":"/BCIJelly-site/docs/next/datasets/invasive/Speech"}}');var l=s(4848),r=s(8453);const t={},a="10_Visual Grating Task",c={},d=[{value:"Preprocessing Pipeline Documentation",id:"preprocessing-pipeline-documentation",level:3},{value:"Dataset",id:"dataset",level:2},{value:"1. Project Overview",id:"1-project-overview",level:2},{value:"2. Key Features",id:"2-key-features",level:2},{value:"3. Core Functions",id:"3-core-functions",level:2},{value:"<code>get_event_indices(mat_file_path)</code>",id:"get_event_indicesmat_file_path",level:3},{value:"<code>process_mat_file(mat_file_path)</code>",id:"process_mat_filemat_file_path",level:3},{value:"4. Usage",id:"4-usage",level:2},{value:"1. Prepare Data",id:"1-prepare-data",level:3},{value:"2. Run the Preprocessing Script",id:"2-run-the-preprocessing-script",level:3},{value:"3. View Results",id:"3-view-results",level:3},{value:"5. Output Data Shape",id:"5-output-data-shape",level:2},{value:"<code>visual garting task.npz</code>",id:"visual-garting-tasknpz",level:3},{value:"6. Preprocessing Steps",id:"6-preprocessing-steps",level:2},{value:"7. Event Label Definitions",id:"7-event-label-definitions",level:2},{value:"8. Processing Statistics",id:"8-processing-statistics",level:2},{value:"9. Troubleshooting",id:"9-troubleshooting",level:2}];function o(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"10_visual-grating-task",children:"10_Visual Grating Task"})}),"\n",(0,l.jsx)(n.h3,{id:"preprocessing-pipeline-documentation",children:"Preprocessing Pipeline Documentation"}),"\n",(0,l.jsx)(n.h2,{id:"dataset",children:"Dataset"}),"\n",(0,l.jsxs)(n.p,{children:["Access the dataset here:\n\ud83d\udd17 ",(0,l.jsx)(n.a,{href:"https://neurotycho.org/visual-grating-task",children:"Visual Grating Task | neurotycho.org"})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"1-project-overview",children:"1. Project Overview"}),"\n",(0,l.jsxs)(n.p,{children:["This project provides a complete preprocessing pipeline for ",(0,l.jsx)(n.strong,{children:"Visual Grating Task"})," ECoG recordings from ",(0,l.jsx)(n.em,{children:"neurotycho.org"}),".\nThe goal is to extract event-related segments from raw ",(0,l.jsx)(n.code,{children:".mat"})," files, perform preprocessing (e.g., common average referencing (CAR), downsampling), and save structured datasets suitable for neural decoding experiments."]}),"\n",(0,l.jsxs)(n.p,{children:["Reference: ",(0,l.jsx)(n.em,{children:"Neural Decoding Using Kernel-Based Functional Representation of ECoG Recordings"})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"2-key-features",children:"2. Key Features"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Load ",(0,l.jsx)(n.code,{children:".mat"})," ECoG recordings from multiple sessions in ",(0,l.jsx)(n.code,{children:"visual_grating_task/data/"})]}),"\n",(0,l.jsxs)(n.li,{children:["Detect and extract specific events: ",(0,l.jsx)(n.strong,{children:"blank"})," and ",(0,l.jsx)(n.strong,{children:"raster"})]}),"\n",(0,l.jsxs)(n.li,{children:["Apply ",(0,l.jsx)(n.strong,{children:"CAR denoising"})," to remove global noise"]}),"\n",(0,l.jsx)(n.li,{children:"Downsample high-frequency ECoG segments to a fixed length"}),"\n",(0,l.jsxs)(n.li,{children:["Save processed samples and metadata in ",(0,l.jsx)(n.code,{children:".npz"})," format"]}),"\n",(0,l.jsx)(n.li,{children:"Generate a processing report with detailed statistics"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"3-core-functions",children:"3. Core Functions"}),"\n",(0,l.jsx)(n.h3,{id:"get_event_indicesmat_file_path",children:(0,l.jsx)(n.code,{children:"get_event_indices(mat_file_path)"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Purpose"}),": Extract start and end indices for each labeled event segment (",(0,l.jsx)(n.code,{children:"blank"}),", ",(0,l.jsx)(n.code,{children:"raster"}),") from the event label channel."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Output"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Dictionary containing event type, segment indices, and label values."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h3,{id:"process_mat_filemat_file_path",children:(0,l.jsx)(n.code,{children:"process_mat_file(mat_file_path)"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Purpose"}),": Process a single ",(0,l.jsx)(n.code,{children:".mat"})," file, extract valid event segments, perform CAR denoising, and downsample."]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Outputs"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:"Structured dictionary containing:"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"samples"}),": ",(0,l.jsx)(n.code,{children:"(num_samples, 300, 128)"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"labels"}),": ",(0,l.jsx)(n.code,{children:"(num_samples,)"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"label_names"}),": ",(0,l.jsx)(n.code,{children:"['blank', 'raster']"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file_info"}),": ",(0,l.jsx)(n.code,{children:"(num_samples,)"}),", source file names"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sample_label_names"}),": event names per sample"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"4-usage",children:"4. Usage"}),"\n",(0,l.jsx)(n.h3,{id:"1-prepare-data",children:"1. Prepare Data"}),"\n",(0,l.jsxs)(n.p,{children:["Place all ",(0,l.jsx)(n.code,{children:".mat"})," files from the Visual Grating Task dataset in:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"visual_grating_task/data/\n"})}),"\n",(0,l.jsx)(n.h3,{id:"2-run-the-preprocessing-script",children:"2. Run the Preprocessing Script"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"python ecog_process_all2.py\n"})}),"\n",(0,l.jsx)(n.h3,{id:"3-view-results",children:"3. View Results"}),"\n",(0,l.jsx)(n.p,{children:"Example output structure:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"visual_grating_task/data/\n\u251c\u2500\u2500 visual garting task.npz        # processed ECoG samples and metadata\n\u251c\u2500\u2500 processing_report1.txt         # processing statistics\n"})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"5-output-data-shape",children:"5. Output Data Shape"}),"\n",(0,l.jsx)(n.h3,{id:"visual-garting-tasknpz",children:(0,l.jsx)(n.code,{children:"visual garting task.npz"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Type"}),": ",(0,l.jsx)(n.code,{children:"numpy.ndarray"})," (within ",(0,l.jsx)(n.code,{children:".npz"})," container)"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Fields"}),":"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"samples"}),": ",(0,l.jsx)(n.code,{children:"[N, 300, 128]"})," \u2192 N samples, 300 time points, 128 ECoG channels"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"labels"}),": ",(0,l.jsx)(n.code,{children:"[N]"})," \u2192 integer class labels (0=blank, 1=raster)"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"label_names"}),": ",(0,l.jsx)(n.code,{children:"['blank', 'raster']"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"file_info"}),": ",(0,l.jsx)(n.code,{children:"[N]"})," \u2192 source file names for each sample"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"sample_label_names"}),": ",(0,l.jsx)(n.code,{children:"[N]"})," \u2192 human-readable labels per sample"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"6-preprocessing-steps",children:"6. Preprocessing Steps"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Load Data"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["Read ",(0,l.jsx)(n.code,{children:".mat"})," files with ",(0,l.jsx)(n.code,{children:"scipy.io.loadmat"})]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsxs)(n.p,{children:["Access ",(0,l.jsx)(n.code,{children:"X"})," matrix:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"X[:128, :]"})," \u2192 128-channel raw ECoG signal"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"X[128, :]"})," \u2192 event labels per time step"]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Event Detection"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"blank"}),": label value in ",(0,l.jsx)(n.code,{children:"[300, 400]"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"raster"}),": label value > 100 and not in ",(0,l.jsx)(n.code,{children:"[300, 400]"})]}),"\n",(0,l.jsx)(n.li,{children:"Extract continuous segments for each event type"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"CAR Denoising"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"car_signal = signal_data - np.mean(signal_data, axis=0, keepdims=True)\n"})}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Segment Selection"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Keep only segments with length \u2265 1920 samples"}),"\n",(0,l.jsxs)(n.li,{children:["Extract ",(0,l.jsx)(n.code,{children:"[start+20 : start+20+1900]"})," to avoid state transition artifacts"]}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Downsampling"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Interpolate 1900 samples \u2192 300 samples per channel"}),"\n"]}),"\n"]}),"\n",(0,l.jsxs)(n.li,{children:["\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.strong,{children:"Sample Assembly"})}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:["Shape each event to ",(0,l.jsx)(n.code,{children:"(300, 128)"})]}),"\n",(0,l.jsx)(n.li,{children:"Store label, class name, and source file info"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"7-event-label-definitions",children:"7. Event Label Definitions"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"Label Value"}),(0,l.jsx)(n.th,{children:"Event Name"}),(0,l.jsx)(n.th,{children:"Condition"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"0"}),(0,l.jsx)(n.td,{children:"blank"}),(0,l.jsx)(n.td,{children:(0,l.jsx)(n.code,{children:"[300, 400]"})})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:"1"}),(0,l.jsx)(n.td,{children:"raster"}),(0,l.jsxs)(n.td,{children:[(0,l.jsx)(n.code,{children:">100"})," and not in ",(0,l.jsx)(n.code,{children:"[300, 400]"})]})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"8-processing-statistics",children:"8. Processing Statistics"}),"\n",(0,l.jsxs)(n.p,{children:["The generated ",(0,l.jsx)(n.code,{children:"processing_report1.txt"})," contains:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Total processed files"}),"\n",(0,l.jsx)(n.li,{children:"Total number of valid samples"}),"\n",(0,l.jsx)(n.li,{children:"Per-class sample counts"}),"\n",(0,l.jsx)(n.li,{children:"Sample counts per original file"}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"9-troubleshooting",children:"9. Troubleshooting"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"MAT file load errors"}),": Check file integrity and MATLAB version compatibility"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"No valid events found"}),": Ensure event label channel exists and matches expected codes"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Unexpected shapes"}),": Verify that all ",(0,l.jsx)(n.code,{children:".mat"})," files have the correct ",(0,l.jsx)(n.code,{children:"X"})," matrix format"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>t,x:()=>a});var i=s(6540);const l={},r=i.createContext(l);function t(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);